<html>  
    <head>  
        <title></title>  
        <script type="text/javascript" src="../javascripts/raphael.js"></script>  
    
        <style type="text/css">  
            #container 
			{  
			margin-left: 30px;
			margin-top: 30px;
            		width: 1320px;
			height:700px;  
          		border: 1px solid #aaa; 
            		}  
			#tip
			{
			position : absolute;
 			border : 1px solid gray;
 			background-color : #CCFFCC;
 			padding : 3px;
 			z-index: 1000;
 			max-width: 300px; /*200*/
			}
	
		</style> 
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
                <script type="text/javascript" src="../javascripts/jquery.qtip-1.0.0-rc3.custom/jquery.qtip-1.0.0-rc3.min.js"></script>
                <script type="text/javascript">
			function draw() 
			{
			 var paper = new Raphael(document.getElementById('container'), 1600, 700);  
			 var rect1 = paper.rect(45, 20, 350, 90, 6); 
       			 var rect2 = paper.rect(475, 20, 350, 90, 6);
			 var rect3 = paper.rect(905, 20, 350, 90, 6);
			 var rect4 = paper.rect(45, 130, 350, 90, 6);
			 var rect5 = paper.rect(475, 130, 350, 90, 6);
			 var rect6 = paper.rect( 905, 130, 350, 90, 6);
			 var rect7 = paper.rect(395, 240, 490, 90, 6);
			 var rect8 = paper.rect(450, 350, 350, 90, 6);
			 var rect9 = paper.rect(45, 450, 350, 90, 6);
			 var rect10 = paper.rect(490, 460, 250, 90, 6);
			 var rect11 = paper.rect(905, 450, 350, 90, 6);
			 var rect12 = paper.rect(45, 560, 350, 90, 6);
			 var rect13 = paper.rect(420, 570, 465, 90, 6);
			 var rect14 = paper.rect(905, 560, 350, 90, 6);
			 
			 var rect1_inner1 = paper.rect(60, 40, 150,55);
			 var rect1_inner1_services = paper.text(100, 140, "");
			 var rect1_inner2 = paper.rect(230, 40,150,55);
			 var rect1_inner2_services = paper.text(320, 140, "");
			 var rect2_inner1 = paper.rect(490, 40, 150,55);
			 var rect2_inner1_services = paper.text(500, 100, "");
			 var rect2_inner2 = paper.rect(660, 40,150,55);
			 var rect2_inner2_services = paper.text(780, 80, "");
			 var rect3_inner1 = paper.rect(920, 40, 150,55);
			 var rect3_inner2 = paper.rect(1085, 40, 150, 55);
			 var rect4_inner1 = paper.rect(60, 150, 150,55);
			 var rect4_inner2 = paper.rect(230, 150,150,55);
			 var rect5_inner1 = paper.rect(490, 150, 150,55);
			 var rect5_inner2 = paper.rect(660, 150,150,55);
			 var rect6_inner1 = paper.rect(920, 150, 150,55);
			 var rect6_inner2 = paper.rect(1085, 150, 150, 55);
			 
			 var rect7_inner1 = paper.rect(410, 265, 140,55);
			 var rect7_inner2 = paper.rect(570, 265,140,55);
			 var rect7_inner3 = paper.rect(730, 265,140,55);
			 var rect8_inner1 = paper.rect(470, 375, 150,55);
			 var rect8_inner2 = paper.rect(635, 375,150,55);
			 var rect9_inner1 = paper.rect(60, 470, 150,55);
			 var rect9_inner1_services = paper.text(180, 510, "");
			 var rect9_inner2 = paper.rect(230, 470, 150, 55);
			 var rect9_inner2_services = paper.text(350, 510, "");
			
			 var rect10_inner = paper.rect(540, 480, 150,55);
			 var rect11_inner1 = paper.rect(920, 470, 150,55);
			  var rect11_inner1_services = paper.text(1040, 510, "");
			 var rect11_inner2 = paper.rect(1085, 470,150,55);
			  var rect11_inner2_services = paper.text(1105, 510, "");
			 var rect12_inner1 = paper.rect(60, 585, 150,55);
			 var rect12_inner2 = paper.rect(230, 585, 150, 55);
			 var rect13_inner1 = paper.rect(430, 590, 140,55);
			 var rect13_inner1_services = paper.text(530, 630, "");
			 var rect13_inner2 = paper.rect(580, 590,140,55);
			 var rect13_inner2_services = paper.text(700, 630, "");
			 var rect13_inner3 = paper.rect(730, 590, 140, 55);
			 var rect13_inner3_services = paper.text(840, 630, "");
			 var rect14_inner1 = paper.rect(920, 585, 150,55);
			 var rect14_inner2 = paper.rect(1085, 585,150,55);
			
			 
		
			 			 
			 var rect1_text = paper.text( 220, 30, "Rabbit MQ"); 
			 var rect2_text = paper.text(640,30, "OS Controller");
			 var rect3_text = paper.text(1080, 30, "MySql");
			  var rect4_text = paper.text(220, 140, "OS Puppet");
			  var rect5_text = paper.text(640, 140, "logstash");
			 var rect6_text = paper.text(1080, 140, "graphite");
			 var rect7_text = paper.text(660, 250, "NVP Controller");
			 var rect8_text = paper.text(635, 360, "OS dhcp");
			 var rect9_text = paper.text( 220, 460, "NVP Gatway Site"); 
			 var rect10_text = paper.text(625,470, "OS Compute");
			 var rect11_text = paper.text(1080, 460, "NVP Gateway Corp");
			  var rect12_text = paper.text(220, 570, "SITECSEG");
			   var rect13_text = paper.text(625, 580, "NVP Service Nodes");
			    var rect14_text = paper.text(1080, 570, "SITECSEG");
			 
			  for(var i=1;i<14;i++)
			  { 
				 eval("rect"+i+"_text.attr({'font-size':12, font:'bold'})");
			  }
		 
			 var rect1_inner1_text = paper.text( 130, 50, "Rabbit MQ"); 
			 var rect2_inner1_text = paper.text(550,50, "Openstratus Controller");
			 var rect3_inner1_text = paper.text(1000, 50, "MySql");
			  var rect4_inner1_text = paper.text(130, 160,"Puppet Master");
			  var rect5_inner1_text = paper.text(550, 160, "logstash");
			  var rect6_inner1_text = paper.text(1000, 160, "graphite");
			 var rect7_inner1_text = paper.text(500, 280, "NVP Controller");
			  var rect8_inner1_text = paper.text(550, 390, "dhcp");
			  var rect9_inner1_text = paper.text( 130, 480, "NVP Gateway"); 
			 var rect10_inner_text = paper.text(600,500, "Openstratus Compute");
			 var rect11_inner1_text = paper.text(1000, 480, "NVP Gateway");
			 var rect12_inner1_text = paper.text(130, 600, "PAN Firewall");
			  var rect13_inner1_text = paper.text(510, 600,"NVP Service Node");
			  var rect14_inner1_text = paper.text(1000, 600, "PAN Firewall");
			  
			 
			 var rect1_inner2_text = paper.text(310,50, "Rabbit MQ");
			 var rect2_inner2_text = paper.text(720,50, "Openstratus Controller");
			 var rect3_inner2_text = paper.text(1170, 50, "MySql");	
			 var rect4_inner2_text = paper.text(310, 160, "Puppet Master");
			  var rect5_inner2_text = paper.text(720, 160, "logstash");
			  var rect6_inner1_text = paper.text(1170, 160, "graphite");
			  var rect7_inner2_text = paper.text(650, 280, "NVP Controller");
			  var rect8_inner2_text = paper.text(690, 390, "dhcp");
			   var rect9_inner2_text = paper.text(310,480, "NVP Gateway");
			
			 var rect11_inner2_text = paper.text(1170, 480, "NVP Gateway");	
			 var rect12_inner2_text = paper.text(310, 600, "PAN Firewall");
			  var rect13_inner2_text = paper.text(650, 600, "NVP Service Node");
			  var rect14_inner2_text = paper.text(1170, 600, "PAN Firewall");
			  var rect7_inner3_text = paper.text(800, 280, "NVP Controller");
			  var rect13_inner3_text = paper.text(790, 600, "NVP Service Node");
			  
			  for(var i =3; i<=14; i++)
			   {
				if(i!=7 && i!=10 && i!=13 && i!=9 && i!=11 && i!=13)
				{
					eval("rect"+i+"_inner1.attr({id:"+i+"1, fill:'#F0F8FF'})");
					eval("rect"+i+"_inner2.attr({id:"+i+"2, fill:'#F0F8FF'})");
				}
				if(i==7)
				{
					eval("rect"+i+"_inner1.attr({id:"+i+"1, fill:'#F0F8FF'})");
					eval("rect"+i+"_inner2.attr({id:"+i+"2, fill:'#F0F8FF'})");
					eval("rect"+i+"_inner3.attr({id:"+i+"3, fill:'#F0F8FF'})");
					
				}
				if(i==10)
				{
					eval("rect"+i+"_inner.attr({id:"+i+", fill:'#F0F8FF'})");
					
				}
			 }
			 
			 
			var xmlhttp = new XMLHttpRequest();
			xmlhttp.onreadystatechange=function()
			{
				if(xmlhttp.readyState==4 && xmlhttp.status==200)  //200-local
				{
				var JSONObject = JSON.parse(xmlhttp.responseText);
				var i =0;
				while(i<JSONObject.length)
				{	
				var host_name = JSONObject[i].host;
				var healthy = JSONObject[i].healthy;
				switch(host_name)
				{
				case "phx8b03c-03f2.stratus.phx.ebay.com":
				{
					if(JSONObject[i].found==true)
					{
					if(healthy==true)
					{
						rect2_inner1.attr({fill:"#00FF00"});
					}
					else
					{
						rect2_inner1.attr({fill:"#FF0000"});		
					}	
					}
					else
					{
						rect2_inner1.attr({fill:"#A9A9A9"});
					}
				}
				case "phx7b02c-8a8a.stratus.phx.ebay.com":
				{
					if(JSONObject[i].found==true)
					{
					if(healthy==true)
					{
					rect2_inner2.attr({fill:"#00FF00"});
					}
					else
					{
					rect2_inner2.attr({fill:"#FF0000"});		
					}		
					}
					else
					{
						rect2_inner2.attr({fill:"#A9A9A9"});
					}
				}
				case "phx7b02c-0c9e.stratus.phx.ebay.com":
				{
					if(JSONObject[i].found==true)
					{
					if(healthy==true)
					{
					rect1_inner1.attr({fill:"#00FF00"});
					}
					else
					{
					rect1_inner1.attr({fill:"#FF0000"});		
					}		
					}
					else
					{
						rect1_inner1.attr({fill:"#A9A9A9"});
					}
				}
				case "phx8b03c-b7aa.stratus.phx.ebay.com":
				{
					if(JSONObject[i].found==true)
					{
					if(healthy==true)
					{
					rect1_inner2.attr({fill:"#00FF00"});
					}
					else
					{
					rect1_inner2.attr({fill:"#FF0000"});		
					}		
					}
					else
					{
						rect1_inner2.attr({fill:"#A9A9A9"});
					}
				}
				case "10.87.199.131.stratus.phx.ebay.com":
				{
					if(JSONObject[i].found==true)
					{
					if(healthy==true)
					{
					rect9_inner1.attr({fill:"#00FF00"});
					}
					else
					{
					rect9_inner1.attr({fill:"#FF0000"});		
					}		
					}
					else
					{
						rect9_inner1.attr({fill:"#A9A9A9"});
					}
				}
				case "10.87.199.132.stratus.phx.ebay.com":
				{
					if(JSONObject[i].found==true)
					{
					if(healthy==true)
					{
					rect9_inner2.attr({fill:"#00FF00"});
					}
					else
					{
					rect9_inner2.attr({fill:"#FF0000"});		
					}		
					}
					else
					{
						rect9_inner2.attr({fill:"#A9A9A9"});
					}
				}
				case "10.87.199.133.stratus.phx.ebay.com":
				{
					if(JSONObject[i].found==true)
					{
					if(healthy==true)
					{
					rect11_inner1.attr({fill:"#00FF00"});
					}
					else
					{
					rect11_inner1.attr({fill:"#FF0000"});		
					}		
					}
					else
					{
						rect1_inner1.attr({fill:"#A9A9A9"});
					}
				}
				case "10.87.199.134.stratus.phx.ebay.com":
				{
					if(JSONObject[i].found==true)
					{
					if(healthy==true)
					{
					rect11_inner2.attr({fill:"#00FF00"});
					}
					else
					{
					rect11_inner2.attr({fill:"#FF0000"});		
					}		
					}
					else
					{
						rect11_inner2.attr({fill:"#A9A9A9"});
					}
				}
				case "10.87.192.101.stratus.phx.ebay.com":
				{
					if(JSONObject[i].found==true)
					{
					if(healthy==true)
					{
					rect13_inner1.attr({fill:"#00FF00"});
					}
					else
					{
					rect13_inner1.attr({fill:"#FF0000"});		
					}	
					}
					else
					{
						rect13_inner1.attr({fill:"#A9A9A9"});
					}	
				}
				case "10.87.194.102.stratus.phx.ebay.com":
				{
					if(JSONObject[i].found==true)
					{
					if(healthy==true)
					{
					rect13_inner2.attr({fill:"#00FF00"});
					}
					else
					{
					rect13_inner2.attr({fill:"#FF0000"});		
					}	
					}
					else
					{
						rect13_inner2.attr({fill:"#A9A9A9"});
					}	
				}
				case "10.87.196.101.stratus.phx.ebay.com":
				{
					if(JSONObject[i].found==true)
					{
					if(healthy==true)
					{
					rect13_inner3.attr({fill:"#00FF00"});
					}
					else
					{
					rect13_inner3.attr({fill:"#FF0000"});		
					}		
					}
					else
					{
						rect13_inner3.attr({fill:"#A9A9A9"});
					}
				}
				
				
				}//switch
				i=i+1;
				}//while i <JSONObjet.length
			
				var tip = $("#tip").hide();
				var tipText = "";
				var over = false;
				for(var i=1; i<=2; i++)
				 {
				eval("rect"+i+"_inner1.hover(handleHoverIn, handleHoverOut);");
				eval("rect"+i+"_inner2.hover(handleHoverIn, handleHoverOut);");
				}
				rect9_inner1.hover(handleHoverIn, handleHoverOut);
				rect9_inner2.hover(handleHoverIn, handleHoverOut);
				rect11_inner1.hover(handleHoverIn, handleHoverOut);
				rect11_inner2.hover(handleHoverIn, handleHoverOut);
				rect13_inner1.hover(handleHoverIn, handleHoverOut);
				rect13_inner2.hover(handleHoverIn, handleHoverOut);
				rect13_inner3.hover(handleHoverIn, handleHoverOut);
				
			 function handleHoverIn() //called for all services (up or down)
			 {	
			 	var x = "<b>Services down:</b><br><ul>";
				var id = this.id;
				switch(id)
				{ 
				case(14):
				var j=0;
				for(var i =0; i<JSONObject[j].down_services.length; i++)
				{
				 x = x +"<li>"+JSONObject[j].down_services[i]+"</li>";	
				}
				x=x+"<li>"+JSONObject[j].down_services[i]+"</li></ul>";
				if(JSONObject[j].found!=false)
				{
				addTip(rect1_inner1.node, x.toString());
				}
				break;
				case (16):
				var j =1;
				for(var i =0; i<JSONObject[j].down_services.length; i++)
				{
				 x = x +"<li>"+JSONObject[j].down_services[i]+"</li>";	
				}
				x=x+"<li>"+JSONObject[j].down_services[i]+"</li></ul>";
				if(JSONObject[j].found!=false)
				{
				addTip(rect1_inner2.node, x);
				}
				break;
				case (18):
				var j =2;
				for(var i =0; i<JSONObject[j].down_services.length; i++)
				{
				 x = x +"<li>"+JSONObject[j].down_services[i]+"</li>";	
				}
				x=x+"<li>"+JSONObject[j].down_services[i]+"</li></ul>";
				if(JSONObject[j].found!=false)
				{
				addTip(rect2_inner1.node, x);
				}
				break;
				case (20):
				var j =3;
				for(var i =0; i<JSONObject[j].down_services.length; i++)
				{
				 x = x +"<li>"+JSONObject[j].down_services[i]+"</li>";	
				}
				x=x+"<li>"+JSONObject[j].down_services[i]+"</li></ul>";
				if(JSONObject[j].found!=false)
				{
				addTip(rect2_inner2.node, x);
				}
				break;
				case (35):
				var j =4;
				if(JSONObject[j].down_services.length!=0)
				{
				for(var i =0; i<JSONObject[j].down_services.length; i++)
				{
				 x = x +"<li>"+JSONObject[j].down_services[i]+"</li>";	
				}
				x=x+"<li>"+JSONObject[j].down_services[i]+"</li></ul>";
				}
				else
				{
				x = "All services are up!";
				}
				if(JSONObject[j].found!=false)
				{
				addTip(rect9_inner1.node, x);
				}
				break;
				case (37):
				var j =5;
				if(JSONObject[j].down_services.length!=0)
				{
				for(var i =0; i<JSONObject[j].down_services.length; i++)
				{
				 x = x +"<li>"+JSONObject[j].down_services[i]+"</li>";	
				}
				x=x+"<li>"+JSONObject[j].down_services[i]+"</li></ul>";
				}
				else
				{
				x = "All services are up!";
				}
				if(JSONObject[j].found!=false)
				{
				addTip(rect9_inner2.node, x);
				}
				break;
				case (40):
				var j =6;
				if(JSONObject[j].down_services.length!=0)
				{
				for(var i =0; i<JSONObject[j].down_services.length; i++)
				{
				 x = x +"<li>"+JSONObject[j].down_services[i]+"</li>";	
				}
				x=x+"<li>"+JSONObject[j].down_services[i]+"</li></ul>";
				}
				else
				{
				x = "All services are up!";
				}
				if(JSONObject[j].found!=false)
				{
				addTip(rect11_inner1.node, x);
				}
				break;
				case (42):
				var j =7;
				if(JSONObject[j].down_services.length!=0)
				{
				for(var i =0; i<JSONObject[j].down_services.length; i++)
				{
				 x = x +"<li>"+JSONObject[j].down_services[i]+"</li>";	
				}
				x=x+"<li>"+JSONObject[j].down_services[i]+"</li></ul>";
				}
				else
				{
				x = "All services are up!";
				}
				if(JSONObject[j].found!=false)
				{
				addTip(rect11_inner2.node, x);
				}
				break;
				case (46):
				var j =8;
				if(JSONObject[j].down_services.length!=0)
				{
				for(var i =0; i<JSONObject[j].down_services.length; i++)
				{
				 x = x +"<li>"+JSONObject[j].down_services[i]+"</li>";	
				}
				x=x+"<li>"+JSONObject[j].down_services[i]+"</li></ul>";
				}
				else
				{
				x = "All services are up!";
				}
				if(JSONObject[j].found!=false)
				{
				addTip(rect13_inner1.node, x);
				}
				break;
				case (48):
				var j =9;
				if(JSONObject[j].down_services.length!=0)
				{
				for(var i =0; i<JSONObject[j].down_services.length; i++)
				{
				 x = x +"<li>"+JSONObject[j].down_services[i]+"</li>";	
				}
				x=x+"<li>"+JSONObject[j].down_services[i]+"</li></ul>";
				}
				else
				{
				x = "All services are up!";
				}
				if(JSONObject[j].found!=false)
				{
				addTip(rect13_inner2.node, x);
				}
				break;
				case (50):
				var j =10;
				if(JSONObject[j].down_services.length!=0)
				{
				for(var i =0; i<JSONObject[j].down_services.length; i++)
				{
				 x = x +"<li>"+JSONObject[j].down_services[i]+"</li>";	
				}
				x=x+"<li>"+JSONObject[j].down_services[i]+"</li></ul>";
				}
				else
				{
				x = "All services are up!";
				}
				if(JSONObject[j].found!=false)
				{
				addTip(rect13_inner3.node, x);
				}
				break;
				
				}
				
			 }
			  function handleHoverOut()
			 {	
			 var id = this.id;
				switch(id)
				{
				case(14):
				rect1_inner1_services.attr('text','');	
				break;
				case(16):
				rect1_inner2_services.attr('text','');	
				break;
				case(18):
				rect2_inner1_services.attr('text','');	
				break;
			 	case(20):
				rect2_inner2_services.attr('text','');	
				break;
				case(35):
				rect9_inner1_services.attr('text','');	
				break;
				case(37):
				rect9_inner2_services.attr('text','');	
				break;
				case(40):
				rect11_inner1_services.attr('text','');	
				break;
				case(42):
				rect11_inner2_services.attr('text','');	
				break;
				case(46):
				rect13_inner1_services.attr('text','');	
				break;
				case(48):
				rect13_inner2_services.attr('text','');	
				break;
				case(50):
				rect13_inner3_services.attr('text','');	
				break;
				}
			 }
		
		}
		
		$(document).mousemove(function(e){//mousemove
  		  if (over)
  		  {
    		       	 tip.css("left", e.clientX+20).css("top", e.clientY+20);
     			 tip.html(tipText);
		  }
		});

		 function addTip(node, txt){
  		  $(node).mouseenter(function(){
      			 tipText = txt;
      	   		 tip.fadeIn("fast");//
      	 	 	over = true;
   			 }).mouseleave(function(){
     	  		tip.fadeOut(500);//200
      	  		over = false;
  	 	 });
		}
		
	} //onreadystatechange ()
			xmlhttp.open("GET","http://localhost:9000/health",true); 
			xmlhttp.send();
			
	}//draw()
</script>
    </head> 
    <body onLoad="return draw()">  
        <div id="container">  </div>
        <div id="i1" align="right"></div>   
        <div id="tip"></div>  
    
    </body>  
</html>  
